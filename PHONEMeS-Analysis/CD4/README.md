# PHONEMeS Analysis - CD4

This directory contains scripts necessary to perform the PHONEMeS analysis for the CD4 cell-lines. In this directory users also need to store a version of the **cplex** executable file.

## Steps to run the analysis

For running the analysis and saving the results in the [Results](https://github.com/saezlab/Prostaglandin_Project/tree/master/Results/PHONEMeS/CD4), users simply have to execute the following scripts:

+ `executionScript.R`: for executing the PHONEMeS analysis.
+ `groupNodes.R`: for preparing the network results in an adaptable format and saving them in the [Results](https://github.com/saezlab/Prostaglandin_Project/tree/master/Results/PHONEMeS/CD4).

Detailed description of how the scripts work are given below:

### Execution script

This is the main script which runs the PHONEMeS analysis.

+ `[1-6]`: Loading the necessary R-packages.
+ `[8-13]`: Sourcing all the functions needed to run the PHONEMeS analysis.
+ `[15]`: Loading the backgrand network generated by [`buildBN.R`](https://github.com/saezlab/Prostaglandin_Project/blob/master/Background-Network/buildBN.R).
+ `[17]`: Loading the PHONEMeS-Inputs generated by [`buildObject_CD4.R`](https://github.com/saezlab/Prostaglandin_Project/blob/master/PHONEMeS-Inputs/buildObject_CD4.R).
+ `[19-22]`: Just renaming the PHONEMeS-Inputs.
+ `[24-26]`: Combining all the PHONEMeS-Inputs in one object.
+ `[28-33]`: Creating the conditions list where each condittion corresponds to either *EP1*, *EP2*, *EP3*, *EP4*, or *PGE2* condition (targegting *EP1*, *EP2*, *EP3* and *EP4* simulatenously).
+ `[37-40]`: Assigning targets to each of the experimental conditions.
+ `[42-43]`: Creating an ampty matrix which will combine all the results of the PHONEMeS analysis. This will only be needed later to assign attributes to nodes ni the network results.
+ `[45-81]`: Executing PHONEMeS for all the 6 cases: **1)** When EP1 is being targeted, **2)** When EP2 is being targeted, **3)** When EP3 is being targeted, **4)** When EP4 is being targeted, **5)** When PGE2 is being applied (targeting EP1, EP2, EP3 and EP4), and **6)** Combination of all of the above 5 experiments.

### Grouping nodes

This script group different sites of a protein in a single node and which arise when exploring the multiple PHONEMeS solutions. After grouping, results are stored in the corresponding [Results](https://github.com/saezlab/Prostaglandin_Project/tree/master/Results/PHONEMeS/CD4) directory.

+ `[1-109]`: Function for grouping the nodes.
+ `[111-138]`: Grouping nodes and saving results and assigned node attributes as tables.
+ `[140-147]`: Removing pesky files generated by the cplex analysis.
